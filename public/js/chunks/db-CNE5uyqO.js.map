{"version":3,"file":"db-CNE5uyqO.js","sources":["../../../src/data/db.js"],"sourcesContent":["import { van, rsv } from \"../rsvan.js\";\nimport { app } from \"./firebase.js\";\nimport { eventBus } from \"../eventbus.js\";\n\nif (typeof global !== \"undefined\" && global._vy_firebase_admin_sdk) {\n    var {\n        getFirestore,\n        doc,\n        collection,\n        setDoc,\n        getDoc,\n        getDocs,\n        deleteDoc,\n        updateDoc,\n        query,\n        orderBy,\n        where,\n        onSnapshot,\n        serverTimestamp,\n        runTransaction,\n    } = await import(\"firebase-admin/firestore\");\n} else {\n    console.log(\"Importing Client Firestore SDK...\");\n    var {\n        getFirestore,\n        doc,\n        collection,\n        setDoc,\n        getDoc,\n        getDocs,\n        deleteDoc,\n        updateDoc,\n        query,\n        orderBy,\n        where,\n        onSnapshot,\n        serverTimestamp,\n        runTransaction,\n    } = await import(\"firebase/firestore\");\n}\n\nclass Database {\n    constructor() {\n        this.db = getFirestore(app);\n    }\n\n    pushid(now = null) {\n        const pushChars =\n            \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz\";\n\n        // Date of original proof of concept video capture\n        const epoch = new Date(2024, 8, 14, 3, 27, 0).getTime(); // Month is 0-indexed in JS\n        now = now || Date.now(); // Current time in ms\n\n        // Encode timestamp into 8 characters\n        const timeStampChars = new Array(8);\n        let timestamp = now - epoch;\n        for (let i = 7; i >= 0; i--) {\n            timeStampChars[i] = pushChars[timestamp % pushChars.length];\n            timestamp = Math.floor(timestamp / pushChars.length);\n        }\n        if (timestamp !== 0) {\n            throw new Error(\"Timestamp didn't fully convert\");\n        }\n\n        const lastRandChars = Array.from({ length: 12 }, () =>\n            Math.floor(Math.random() * pushChars.length)\n        );\n        const randChars = lastRandChars.map((i) => pushChars[i]);\n\n        return timeStampChars.concat(randChars).join(\"\");\n    }\n\n    async set(collectionName, docData) {\n        if (!docData.id) {\n            docData.id = this.pushid();\n            docData.created = serverTimestamp();\n        }\n\n        docData.updated = serverTimestamp();\n        const docRef = doc(this.db, collectionName, docData.id);\n        await setDoc(docRef, docData);\n\n        return docData.id;\n    }\n\n    async get(collectionName, docId) {\n        const docRef = doc(this.db, collectionName, docId);\n        const docSnap = await getDoc(docRef);\n\n        if (!docSnap.exists()) {\n            return null;\n        }\n\n        const data = docSnap.data();\n        data.id = docSnap.id;\n        return data;\n    }\n\n    async query(collectionName, filters = null, order = null) {\n        let q = collection(this.db, collectionName);\n\n        if (filters) {\n            for (const [key, value] of Object.entries(filters)) {\n                if (\n                    typeof value === \"object\" &&\n                    value !== null &&\n                    !Array.isArray(value)\n                ) {\n                    const op = value.op || \"==\";\n                    const val = value.value;\n                    q = query(q, where(key, op, val));\n                } else if (Array.isArray(value)) {\n                    q = query(q, where(key, \"in\", value));\n                } else {\n                    q = query(q, where(key, \"==\", value));\n                }\n            }\n\n            if (order) {\n                q = query(q, orderBy(order));\n            }\n        }\n\n        const querySnapshot = await getDocs(q);\n        const results = [];\n\n        querySnapshot.forEach((doc) => {\n            const data = doc.data();\n            data.id = doc.id;\n            results.push(data);\n        });\n\n        return results;\n    }\n\n    async delete(collectionName, docId) {\n        const docRef = doc(this.db, collectionName, docId);\n        await deleteDoc(docRef);\n        return true;\n    }\n\n    async update(collectionName, docId, updates) {\n        const docRef = doc(this.db, collectionName, docId);\n        updates.updated = serverTimestamp();\n        await updateDoc(docRef, updates);\n        return true;\n    }\n\n    async atomicUpdate(\n        collectionName,\n        docId,\n        column,\n        oldValue,\n        newValue,\n        updates = {}\n    ) {\n        const docRef = doc(this.db, collectionName, docId);\n\n        try {\n            const result = await runTransaction(\n                this.db,\n                async (transaction) => {\n                    const docSnap = await transaction.get(docRef);\n\n                    if (\n                        docSnap.exists() &&\n                        docSnap.data()[column] === oldValue\n                    ) {\n                        const updateData = {\n                            [column]: newValue,\n                            updated: serverTimestamp(),\n                            ...updates,\n                        };\n                        transaction.update(docRef, updateData);\n                        return true;\n                    }\n\n                    return false;\n                }\n            );\n\n            return result;\n        } catch (error) {\n            console.error(\"Transaction failed: \", error);\n            return false;\n        }\n    }\n\n    listen(collectionName, callback, filters = null) {\n        let q = collection(this.db, collectionName);\n\n        if (filters) {\n            for (const [key, value] of Object.entries(filters)) {\n                if (\n                    typeof value === \"object\" &&\n                    value !== null &&\n                    !Array.isArray(value)\n                ) {\n                    const op = value.op || \"==\";\n                    const val = value.value;\n                    q = query(q, where(key, op, val));\n                } else if (Array.isArray(value)) {\n                    q = query(q, where(key, \"in\", value));\n                } else {\n                    q = query(q, where(key, \"==\", value));\n                }\n            }\n        }\n\n        return onSnapshot(q, (querySnapshot) => {\n            const results = [];\n\n            querySnapshot.docChanges().forEach((change) => {\n                if (change.type === \"added\" || change.type === \"modified\") {\n                    const data = change.doc.data();\n                    data.id = change.doc.id;\n                    results.push(data);\n                }\n            });\n\n            if (results.length > 0) {\n                callback(results);\n            }\n        });\n    }\n\n    watch(collectionName, docId, callback) {\n        const docRef = doc(this.db, collectionName, docId);\n\n        return onSnapshot(docRef, (docSnap) => {\n            if (docSnap.exists()) {\n                const data = docSnap.data();\n                data.id = docSnap.id;\n                callback(data);\n            }\n        });\n    }\n\n    stop(listener) {\n        listener();\n    }\n}\n\nclass Form {\n    constructor(collection, fields) {\n        this.collection = collection;\n        this.fields = fields;\n        this.db = new Database();\n        eventBus.addEventListener(`${this.collection}FormSubmitClick`, (e) => {\n            this.handleSubmit();\n        });\n    }\n\n    async handleSubmit() {\n        const formData = Object.fromEntries(\n            Array.from(this.fields).map((field) => {\n                const fieldName = field.name;\n                const fieldId = field.id || `${fieldName}Input`;\n                const fieldValue = document.getElementById(fieldId).value;\n                return [fieldName, fieldValue];\n            })\n        );\n\n        console.log(\"Form data:\", formData);\n        try {\n            const docId = await this.db.set(this.collection, formData);\n            console.log(\"Document written with ID: \", docId);\n        } catch (error) {\n            console.error(\"Error adding document: \", error);\n        }\n    }\n\n    getElementsForField(field) {\n        const { label, input, div } = van.tags;\n\n        const fieldName = field.name;\n        const fieldId = field.id || `${fieldName}Input`;\n        const fieldDisplayName = field.displayName || fieldName;\n        const isRequired = field.required || false;\n        const fieldType = field.type || \"text\";\n        const containerClass = field.containerClass || \"w-full\";\n\n        return div(\n            { class: containerClass },\n            label(\n                {\n                    for: fieldId,\n                    class: \"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2\",\n                },\n                fieldDisplayName\n            ),\n            input({\n                id: fieldId,\n                name: fieldName,\n                type: fieldType,\n                placeholder: fieldDisplayName,\n                required: isRequired,\n                class: \"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline\",\n            })\n        );\n    }\n\n    addElements(parentElement) {\n        const { div } = van.tags;\n        const { button } = rsv.tags;\n\n        parentElement =\n            parentElement ||\n            document.getElementById(\"form-container\") ||\n            document.body;\n\n        var rows = [];\n\n        for (var i = 0; i < this.fields.length; i++) {\n            const field = this.fields[i];\n            const fieldRow = field.row || i;\n            const fieldElements = this.getElementsForField(field);\n\n            if (!rows[fieldRow])\n                rows[fieldRow] = div({ class: \"mb-4 flex space-x-4\" });\n\n            van.add(rows[fieldRow], fieldElements);\n        }\n\n        rows.push(\n            div(\n                { class: \"flex justify-center items-center mt-8\" },\n                button({ name: `${this.collection}FormSubmit` }, \"Submit\")\n            )\n        );\n\n        van.add(\n            parentElement,\n            div(\n                { class: \"flex justify-center items-center mt-8\" },\n                div(\n                    {\n                        class: \"bg-white dark:bg-gray-800 shadow-md rounded px-8 pt-6 pb-8 mb-4 w-1/3\",\n                    },\n                    rows\n                )\n            )\n        );\n    }\n}\n\nclass List {\n    constructor(collection, fields) {\n        this.collection = collection;\n        this.fields = fields;\n        this.db = new Database();\n    }\n\n    getElementsForField(field) {\n        const { label, span, div } = van.tags;\n\n        const fieldName = field.name;\n        const fieldId = field.id || `${fieldName}Text`;\n        const fieldDisplayName = field.displayName || fieldName;\n        const containerClass = field.containerClass || \"w-full\";\n\n        return div(\n            { class: containerClass },\n            label(\n                {\n                    for: fieldId,\n                    class: \"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2\",\n                },\n                fieldDisplayName\n            ),\n            span({\n                id: fieldId,\n                class: \"w-full py-2 px-3 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 leading-tight\",\n            })\n        );\n    }\n\n    addElements(parentElement) {\n        const { div } = van.tags;\n        const { button } = rsv.tags;\n\n        parentElement =\n            parentElement ||\n            document.getElementById(\"list-container\") ||\n            document.body;\n\n        var rows = [];\n\n        for (var i = 0; i < this.fields.length; i++) {\n            const field = this.fields[i];\n            const fieldRow = field.row || i;\n            const fieldElements = this.getElementsForField(field);\n\n            if (!rows[fieldRow])\n                rows[fieldRow] = div({ class: \"mb-4 flex space-x-4\" });\n\n            van.add(rows[fieldRow], fieldElements);\n        }\n\n        rows.push(\n            div(\n                { class: \"flex justify-center items-center mt-8\" },\n                button({ name: `${this.collection}Add` }, \"Add\")\n            )\n        );\n\n        van.add(\n            parentElement,\n            div(\n                { class: \"flex justify-center items-center mt-8\" },\n                div(\n                    {\n                        class: \"bg-white dark:bg-gray-800 shadow-md rounded px-8 pt-6 pb-8 mb-4 w-1/3\",\n                    },\n                    rows\n                )\n            )\n        );\n    }\n\n    async getItems() {\n        return await this.db.query(this.collection);\n    }\n}\n\nlet database = new Database();\n\nfunction changeDatabase(newDb) {\n    database = newDb;\n}\n\n// let firestore = getFirestore(app);\n\nif (typeof window !== \"undefined\") {\n    window._vy_database = database;\n}\n\nexport default database;\nexport {\n    // firestore,\n    // getFirestore,\n    // doc,\n    // collection,\n    // addDoc,\n    // setDoc,\n    // getDoc,\n    // getDocs,\n    // deleteDoc,\n    // updateDoc,\n    // query,\n    // orderBy,\n    // where,\n    // onSnapshot,\n    // serverTimestamp,\n    // runTransaction,\n    database,\n    Database,\n    Form,\n    List,\n    changeDatabase,\n};\n"],"names":[],"mappings":"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"}